syntax = "proto3";

package user.v1;

import "google/api/annotations.proto";
import "google/api/client.proto";
import "google/api/field_behavior.proto";
import "google/protobuf/empty.proto";
import "rules/v1/rules.proto";

// Represents user specific actions
service UserService {
  option (google.api.default_host) = "api.lasthearth.ru";

  rpc UpdateAvatar(UpdateAvatarRequest) returns (google.protobuf.Empty) {
    option (google.api.http) = {
      post: "/v1/user/avatar"
      body: "*"
    };
  }

  rpc GetUser(GetUserRequest) returns (GetUserResponse) {
    option (google.api.http) = {get: "/v1/user/{user_id}"};
  }

  rpc SearchUsers(SearchUsersRequest) returns (SearchUsersResponse) {
    option (google.api.http) = {get: "/v1/user/search"};
  }
}

message UpdateAvatarRequest {
  bytes avatar = 1 [(google.api.field_behavior) = REQUIRED];
}

message GetUserRequest {
  string user_id = 1 [(google.api.field_behavior) = REQUIRED];
}

message GetUserResponse {
  string user_id = 1;
  string user_game_name = 2;
  Image avatar = 3;

  message Image {
    string original = 1;
    string x96 = 2;
    string x48 = 3;
  }
}

message SearchUsersRequest {
  string query = 1 [(google.api.field_behavior) = REQUIRED];
}

message SearchUsersResponse {
  repeated GetUserResponse users = 1;
}
